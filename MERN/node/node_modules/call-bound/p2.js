const express = require('express');
const customerApp = express();

// Middleware to parse JSON and URL-encoded data
customerApp.use(express.json());
customerApp.use(express.urlencoded({ extended: true }));

// Home route
customerApp.get('/', (req, res) => {
    res.send('Welcome!');
});

// Get customer by ID
// Example: GET http://localhost:2002/customer/1234
customerApp.get('/customer/:customerId', (req, res) => {
    const custId = req.params.customerId;
    res.send(`Customer Information fetched for Customer ID: ${custId}`);
});

// Search customer by name
// Example: GET http://localhost:2002/customer/searchByName/abd
customerApp.get('/customer/searchByName/:customerName', (req, res) => {
    const custName = req.params.customerName;
    res.send(`Customer information fetched by name: ${custName}`);
});

// Search customer by mobile number
// Example: GET http://localhost:2002/customer/searchByMobile/98765
customerApp.get('/customer/searchByMobile/:mobileNumber', (req, res) => {
    const mobile = req.params.mobileNumber;
    res.send(`Customer information fetched by mobile number: ${mobile}`);
});

// Save customer information using POST
// Example: POST http://localhost:2002/customer
// Body: { "customerId": 1, "customerName": "Ali", "mobileNumber": "98765", "billAmount": 1000 }
customerApp.post('/customer', (req, res) => {
    const { customerId, customerName, mobileNumber, billAmount } = req.body;

    res.status(201).send(
        `Customer saved successfully with ID: ${customerId}, Name: ${customerName}, Mobile: ${mobileNumber}, Bill: ₹${billAmount}`
    );
});

// Update customer information using PUT
// Example: PUT http://localhost:2002/customer/1
// Body: { "customerName": "Ali Updated", "mobileNumber": "99999", "billAmount": 1500 }
customerApp.put('/customer/:customerId', (req, res) => {
    const customerId = req.params.customerId;
    const { customerName, mobileNumber, billAmount } = req.body;

    res.status(200).send(
        `Customer updated successfully with ID: ${customerId}, Name: ${customerName}, Mobile: ${mobileNumber}, Bill: ₹${billAmount}`
    );
});

// Start the server
customerApp.listen(2002, () => {
    console.log("Customer app is running on http://localhost:2002");
});
